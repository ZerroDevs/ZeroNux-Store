{
    "rules": {
        ".read": false,
        ".write": false,
        "products": {
            ".read": true,
            ".write": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()"
        },
        "settings": {
            ".read": true,
            ".write": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()"
        },
        "orders": {
            ".read": "auth != null && (root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists() || (query.orderByChild == 'userId' && query.equalTo == auth.uid))",
            ".write": true,
            ".indexOn": [
                "userId"
            ],
            "$orderId": {
                ".read": "auth != null && (data.child('userId').val() === auth.uid || root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists())"
            }
        },
        "promos": {
            ".read": true,
            ".indexOn": [
                "code"
            ],
            "$promoId": {
                ".write": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()",
                "usedCount": {
                    ".write": true
                }
            }
        },
        "studentBooks": {
            ".read": true,
            ".write": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()"
        },
        "bookRequests": {
            ".read": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()",
            ".write": true
        },
        "activityLog": {
            ".read": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()",
            ".write": "auth != null",
            ".indexOn": [
                "timestamp"
            ]
        },
        "supportTickets": {
            ".read": true,
            ".write": true,
            ".indexOn": [
                "visitorId",
                "status",
                "createdAt"
            ]
        },
        "seoSettings": {
            ".read": true,
            ".write": "auth != null && root.child('settings/adminEmails').child(auth.token.email.replace('.', ',')).exists()"
        },
        "userProfiles": {
            ".indexOn": [
                "visitorId"
            ],
            "$uid": {
                ".read": "$uid === auth.uid || $uid.beginsWith('visitor_')",
                ".write": "$uid === auth.uid || $uid.beginsWith('visitor_')"
            }
        },
        "reviews": {
            ".read": true,
            ".write": true,
            ".indexOn": [
                "productId",
                "visitorId",
                "timestamp"
            ]
        }
    }
}